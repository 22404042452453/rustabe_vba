# Script Rustab

Набор скриптов на VBScript для анализа устойчивости энергосистем с использованием ПО Rastr.

## Описание

Проект содержит скрипты для расчета критического времени отключения коротких замыканий (КЗ), анализа инвариантов, сценариев и ремонтов в энергосистемах. Скрипты выполняют динамические расчеты, анализируют устойчивость генераторов и генерируют отчеты в Microsoft Excel.

## Файлы

- `critical_time.txt`: Скрипт для определения критического времени отключения КЗ с использованием бинарного поиска. Рассчитывает время, при котором нарушается устойчивость системы.
- `инварианты_сценарии.txt`: Скрипт для анализа инвариантов и сценариев. Обрабатывает файлы сценариев (.scn) и вычисляет параметры устойчивости для генераторов.
- `инварианты_сценарии_ремонты.txt`: Скрипт для анализа инвариантов, сценариев и ремонтов. Включает комбинаторный анализ ремонтов линий и расчет динамики.

## Требования

- ПО Rastr (версия, поддерживающая FWDynamic и таблицы Generator, ветвь, узел).
- Microsoft Excel (для генерации отчетов).
- Операционная система Windows с поддержкой VBScript (cscript.exe).
- Доступ к COM-объектам Rastr.

## Установка и настройка

1. Установите ПО Rastr и убедитесь, что оно зарегистрировано как COM-сервер.
2. Установите Microsoft Excel.
3. Скачайте или скопируйте скрипты в удобную папку.
4. Откройте скрипты в текстовом редакторе и настройте пути:
   - `ScenarioTemplatePath`: Путь к шаблонному файлу сценария (.scn).
   - `ScenarioFolderPath`: Папка с файлами сценариев (.scn).

## Использование

1. Переименуйте файлы `.txt` в `.vbs` для удобства запуска (или запустите через командную строку: `cscript script.vbs`).
2. Запустите скрипт двойным кликом или через командную строку.
3. Следуйте инструкциям в диалоговых окнах (ввод параметров КЗ, выбор генераторов и т.д.).
4. Результаты будут сохранены в новом файле Excel с листами "Данные", "Результаты" и "Логи" (для critical_time.txt).

### Примечания

- Скрипты предполагают наличие выбранных генераторов в таблице Generator Rastr (поле "sel").
- Для скриптов с ремонтами требуется предварительная настройка полей "Repair" и "Report" в таблице ветвь.
- В случае ошибок проверьте пути к файлам и доступность COM-объектов Rastr.

## Автор

Проект разработан для анализа энергосистем с использованием Rastr.

## Лицензия

(Укажите лицензию, если применимо)
