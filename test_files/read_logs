' --- Поиск всех свойств FWDynamic ---

' Инициализация Excel для результатов
Set xl = CreateObject("Excel.Application")
xl.Visible = True
xl.DisplayAlerts = False
Set wb = xl.Workbooks.Add
Set ws = wb.Worksheets(1)
ws.Name = "Свойства"

' Заголовок
ws.Cells(1, 1).Value = "№"
ws.Cells(1, 2).Value = "Свойство"
ws.Cells(1, 3).Value = "Значение/Результат"
ws.Range("A1:C1").Font.Bold = True

' Запускаем расчет динамики
Set spFWDynamic = Rastr.FWDynamic

If Not spFWDynamic Is Nothing Then
    nRes = spFWDynamic.Run()
    
    If nRes = 0 Then
        rowNum = 2
        On Error Resume Next
        
        ' Список возможных свойств для проверки
        properties = Array("ResultMessage", "AdditionalInformation", "Messages", _
                          "Log", "Logs", "EventLog", "Events", "EventList", _
                          "LogList", "ResultLog", "DetailedLog", "FullLog", _
                          "CalculationLog", "DynamicLog", "ProtectionLog", _
                          "ARLog", "BlockingLog", "AngleLog", "GeneratorLog")
        
        For i = 0 To UBound(properties)
            ws.Cells(rowNum, 1).Value = i + 1
            ws.Cells(rowNum, 2).Value = properties(i)
            
            ' Пробуем получить значение
            Select Case properties(i)
                Case "ResultMessage"
                    val = spFWDynamic.ResultMessage
                Case "AdditionalInformation"
                    val = spFWDynamic.AdditionalInformation
                Case "Messages"
                    val = spFWDynamic.Messages
                Case "Log"
                    val = spFWDynamic.Log
                Case "Logs"
                    val = spFWDynamic.Logs
                Case "EventLog"
                    val = spFWDynamic.EventLog
                Case "Events"
                    val = spFWDynamic.Events
                Case "EventList"
                    val = spFWDynamic.EventList
                Case "LogList"
                    val = spFWDynamic.LogList
                Case "ResultLog"
                    val = spFWDynamic.ResultLog
                Case "DetailedLog"
                    val = spFWDynamic.DetailedLog
                Case "FullLog"
                    val = spFWDynamic.FullLog
                Case "CalculationLog"
                    val = spFWDynamic.CalculationLog
                Case "DynamicLog"
                    val = spFWDynamic.DynamicLog
                Case "ProtectionLog"
                    val = spFWDynamic.ProtectionLog
                Case "ARLog"
                    val = spFWDynamic.ARLog
                Case "BlockingLog"
                    val = spFWDynamic.BlockingLog
                Case "AngleLog"
                    val = spFWDynamic.AngleLog
                Case "GeneratorLog"
                    val = spFWDynamic.GeneratorLog
            End Select
            
            If IsEmpty(val) Then
                ws.Cells(rowNum, 3).Value = "(пусто)"
            ElseIf IsNull(val) Then
                ws.Cells(rowNum, 3).Value = "(null)"
            ElseIf val = "" Then
                ws.Cells(rowNum, 3).Value = "(пустая строка)"
            Else
                ws.Cells(rowNum, 3).Value = Left(CStr(val), 500)
            End If
            
            rowNum = rowNum + 1
        Next
        
        On Error GoTo 0
        
        ws.Columns.AutoFit
        ws.Columns("C:C").ColumnWidth = 100
        
        MsgBox "Проверка свойств завершена", vbInformation, "Готово"
    Else
        MsgBox "Ошибка расчета FWDynamic (код: " & nRes & ")", vbExclamation, "Ошибка"
    End If
Else
    MsgBox "FWDynamic недоступен", vbCritical, "Ошибка"
End If
