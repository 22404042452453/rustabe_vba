' --- Модуль класса (вставьте в новый модуль класса, назовите его "RastrEvents") ---
Option Explicit

Public WithEvents RastrObj As Object
Private ws As Worksheet
Private rowNum As Long

Public Sub Initialize(rastrInstance As Object, worksheet As Worksheet, startRow As Long)
    Set RastrObj = rastrInstance
    Set ws = worksheet
    rowNum = startRow
End Sub

Private Sub RastrObj_OnLog(ByVal Code As Long, ByVal Level As Long, _
                           ByVal StageId As Long, ByVal TableName As String, _
                           ByVal TableIndex As Long, ByVal Description As String, _
                           ByVal FormName As String)
    ws.Cells(rowNum, 1).Value = rowNum - 1
    ws.Cells(rowNum, 2).Value = "OnLog"
    ws.Cells(rowNum, 3).Value = Description
    rowNum = rowNum + 1
    
    Debug.Print "OnLog: " & Description
End Sub

Private Sub RastrObj_prot(ByVal str As String)
    ws.Cells(rowNum, 1).Value = rowNum - 1
    ws.Cells(rowNum, 2).Value = "prot"
    ws.Cells(rowNum, 3).Value = str
    rowNum = rowNum + 1
    
    Debug.Print "prot: " & str
End Sub
