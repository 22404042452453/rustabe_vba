' Самый простой вариант - прямое получение логов

Set xl = CreateObject("Excel.Application")
xl.Visible = True
Set wb = xl.Workbooks.Add
Set ws = wb.Worksheets(1)

ws.Cells(1, 1).Value = "Логи динамики"
ws.Cells(1, 1).Font.Bold = True

Set spFWDynamic = Rastr.FWDynamic
nRes = spFWDynamic.Run()

' ВАРИАНТ 1: Через ResultMessage
resultMsg = spFWDynamic.ResultMessage
If Len(resultMsg) > 0 Then
    lines = Split(resultMsg, vbCrLf)
    For i = 0 To UBound(lines)
        ws.Cells(i + 2, 1).Value = lines(i)
    Next
End If

' ВАРИАНТ 2: Через Protocol (если есть)
' protocol = spFWDynamic.Protocol
' ws.Cells(2, 1).Value = protocol

' ВАРИАНТ 3: Через таблицу prot
' Set tProt = Rastr.Tables("prot")
' For i = 0 To tProt.Count - 1
'     ws.Cells(i + 2, 1).Value = tProt.Cols("Message").ZN(i)
' Next

ws.Columns.AutoFit
MsgBox "Готово! Код возврата: " & nRes, vbInformation
