' --- Выгрузка логов ResultMessage в Excel ---

' Инициализация Excel для результатов
Set xl = CreateObject("Excel.Application")
xl.Visible = True
xl.DisplayAlerts = False
Set wb = xl.Workbooks.Add
Set ws = wb.Worksheets(1)
ws.Name = "Логи"

' Заголовок
ws.Cells(1, 1).Value = "Текст лога"
ws.Range("A1").Font.Bold = True

' Запускаем расчет динамики
Set spFWDynamic = Rastr.FWDynamic

If Not spFWDynamic Is Nothing Then
    nRes = spFWDynamic.Run()
    
    If nRes = 0 Then
        ' Прямая запись ResultMessage в ячейку
        ws.Cells(2, 1).Value = spFWDynamic.ResultMessage
        
        ' Включаем перенос текста в ячейке
        ws.Cells(2, 1).WrapText = True
        
        ' Форматирование
        ws.Columns("A:A").ColumnWidth = 150
        ws.Rows("2:2").AutoFit
        
        MsgBox "Логи выгружены в ячейку A2", vbInformation, "Выгрузка завершена"
    Else
        MsgBox "Ошибка расчета FWDynamic (код: " & nRes & ")", vbExclamation, "Ошибка"
    End If
Else
    MsgBox "FWDynamic недоступен", vbCritical, "Ошибка"
End If
