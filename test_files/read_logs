' Минимальный код получения логов через addinRastrProtocolViewer
Set viewer = Rastr.Create("addinRastrProtocolViewer")
Set xl = CreateObject("Excel.Application")
xl.Visible = True
Set wb = xl.Workbooks.Add
Set ws = wb.Worksheets(1)

' Запуск расчёта
nRes = Rastr.FWDynamic.Run()

' Получение логов через viewer
On Error Resume Next
logs = viewer.GetProtocol()  ' или viewer.Protocol
On Error GoTo 0

' Вывод в Excel
ws.Cells(1, 1).Value = "Логи RastrWin"
ws.Cells(1, 1).Font.Bold = True

If Len(logs) > 0 Then
    lines = Split(logs, vbCrLf)
    For i = 0 To UBound(lines)
        ws.Cells(i + 2, 1).Value = lines(i)
    Next
Else
    ws.Cells(2, 1).Value = "(логи пусты)"
End If

ws.Columns.AutoFit
MsgBox "Готово! Код: " & nRes, vbInformation
