' Скрипт для изменения длительности действия "Шунт Z"

' Функция установки длительности
Sub SetShuntDuration(tClear)
    On Error Resume Next
    
    Set tblEvents = Rastr.Tables("DFWAutoActionScn")
    
    If Not tblEvents Is Nothing Then
        Set colType = tblEvents.Cols("Type")
        Set colName = tblEvents.Cols("Name")
        Set colDT = tblEvents.Cols("DT")
        
        If Not colType Is Nothing And Not colDT Is Nothing Then
            ' Ищем действие типа "Объект" с названием, содержащим "Шунт Z"
            For i = 0 To tblEvents.Size - 1
                If colType.ZS(i) = "Объект" And InStr(colName.ZS(i), "Шунт Z") > 0 Then
                    ' Устанавливаем длительность в мс
                    colDT.Z(i) = tClear
                    MsgBox "Длительность установлена: " & tClear & " мс" & vbCrLf & _
                           "Для действия: " & colName.ZS(i)
                    Exit For
                End If
            Next
        End If
    End If
    
    On Error GoTo 0
End Sub

' Основная логика
tInput = InputBox("Введите длительность (мс):", "Изменение длительности", "1")

If IsNumeric(tInput) Then
    tClear = CDbl(tInput)
    Call SetShuntDuration(tClear)
Else
    MsgBox "Неверный ввод времени."
End If
