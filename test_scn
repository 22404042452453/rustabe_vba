' Скрипт для изменения времени отключения КЗ в сценарии и сохранения

' Функция установки времени отключения КЗ
Sub SetShortCircuitClearingTime(tClear)
    On Error Resume Next
    Set tblEvents = Rastr.Tables("DWFAutoActionScn")
    If Not tblEvents Is Nothing Then
        Set colType = tblEvents.Cols("Type")
        Set colOtkl = tblEvents.Cols("Шунт Z")
        If Not colType Is Nothing And Not colOtkl Is Nothing Then
            For i = 0 To tblEvents.Size - 1
                If colType.ZS(i) = "КЗ" Then
                    colOtkl.Z(i) = tClear
                    Exit For
                End If
            Next
        End If
    End If
    On Error GoTo 0
End Sub

' Основная логика
tInput = InputBox("Введите время отключения КЗ (мс):", "Изменение времени", "500")

If IsNumeric(tInput) Then
    tClear = CDbl(tInput)

    ' Устанавливаем время в сценарии
    Call SetShortCircuitClearingTime(tClear)

    ' Сохраняем сценарий
    saveRes = Rastr.Save()
    If saveRes = 0 Then
        MsgBox "Время отключения КЗ установлено: " & tClear & " мс" & vbCrLf & "Сценарий сохранен."
    Else
        MsgBox "Ошибка сохранения сценария: " & saveRes
    End If
Else
    MsgBox "Неверный ввод времени."
End If
