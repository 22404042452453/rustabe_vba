' --- Скрипт для отладки: Вывод структуры таблицы DFWAutoActionScn ---

Set tblEvents = Rastr.Tables("DFWAutoActionScn")

If tblEvents Is Nothing Then
    MsgBox "Ошибка: Таблица DFWAutoActionScn не найдена!" & vbCrLf & _
           "Возможно, нужно использовать другое имя таблицы.", vbCritical
    WScript.Quit
End If

' Выводим все колонки таблицы
Dim colInfo: colInfo = "Колонки таблицы DFWAutoActionScn:" & vbCrLf & vbCrLf

Set cols = tblEvents.Cols
For i = 0 To cols.Count - 1
    Set col = cols.Item(i)
    colInfo = colInfo & "Колонка " & i & ": " & col.Name & vbCrLf
Next

colInfo = colInfo & vbCrLf & "Всего колонок: " & cols.Count & vbCrLf
colInfo = colInfo & "Всего строк: " & tblEvents.Size

MsgBox colInfo, vbInformation, "Структура таблицы"

' Если есть строки - выводим пример первой строки
If tblEvents.Size > 0 Then
    Dim rowInfo: rowInfo = "Пример первой строки:" & vbCrLf & vbCrLf
    
    For i = 0 To cols.Count - 1
        Set col = cols.Item(i)
        On Error Resume Next
        Dim val
        val = col.ZS(0)
        If Err.Number <> 0 Then
            val = col.Z(0)
        End If
        If Err.Number = 0 Then
            rowInfo = rowInfo & col.Name & " = " & val & vbCrLf
        Else
            rowInfo = rowInfo & col.Name & " = [недоступно]" & vbCrLf
        End If
        On Error GoTo 0
    Next
    
    MsgBox rowInfo, vbInformation, "Первая строка"
End If
